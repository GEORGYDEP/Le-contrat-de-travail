<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Contrat Quest - Ma√Ætrise le Droit du Travail Belge!</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6C63FF;
            --secondary: #FF6B6B;
            --accent: #4ECDC4;
            --success: #2ECC71;
            --warning: #F39C12;
            --danger: #E74C3C;
            --dark: #2D3436;
            --light: #F8F9FA;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: var(--light);
            overflow-x: hidden;
        }

        /* Animated background particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            animation: float 15s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }

        /* Header */
        header {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Fredoka One', cursive;
            font-size: 1.8rem;
            background: var(--gradient-3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-display {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .score-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255,255,255,0.1);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 700;
        }

        .score-item .icon {
            font-size: 1.2rem;
        }

        /* Main container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 3rem;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .welcome-title {
            font-family: 'Fredoka One', cursive;
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: var(--gradient-3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-subtitle {
            font-size: 1.3rem;
            opacity: 0.8;
            margin-bottom: 2rem;
        }

        /* Characters */
        .characters {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 3rem 0;
        }

        .character {
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .character:hover {
            transform: scale(1.05);
        }

        .character-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            margin-bottom: 1rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .character-avatar.emma {
            background: var(--gradient-2);
        }

        .character-avatar.hugo {
            background: var(--gradient-1);
        }

        .character-avatar::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        .character-name {
            font-weight: 800;
            font-size: 1.2rem;
        }

        .character-job {
            opacity: 0.7;
            font-size: 0.9rem;
        }

        .character-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-top: 0.5rem;
        }

        .badge-cdi { background: var(--success); }
        .badge-cdd { background: var(--warning); }

        /* Modules Grid */
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .module-card {
            background: rgba(255,255,255,0.08);
            border-radius: 20px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .module-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 20px 40px rgba(78, 205, 196, 0.2);
        }

        .module-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .module-card.completed {
            border-color: var(--success);
        }

        .module-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .module-title {
            font-weight: 800;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .module-desc {
            opacity: 0.7;
            font-size: 0.9rem;
        }

        .module-progress {
            margin-top: 1rem;
            background: rgba(255,255,255,0.1);
            height: 8px;
            border-radius: 10px;
            overflow: hidden;
        }

        .module-progress-bar {
            height: 100%;
            background: var(--gradient-4);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Game Screen */
        .game-screen {
            display: none;
            animation: fadeInUp 0.5s ease;
        }

        .game-screen.active {
            display: block;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .back-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .game-title {
            font-family: 'Fredoka One', cursive;
            font-size: 2rem;
            background: var(--gradient-3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Question Card */
        .question-card {
            background: rgba(255,255,255,0.1);
            border-radius: 25px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .question-number {
            display: inline-block;
            background: var(--gradient-1);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 700;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .question-context {
            background: rgba(78, 205, 196, 0.1);
            border-left: 4px solid var(--accent);
            padding: 1rem 1.5rem;
            border-radius: 0 15px 15px 0;
            margin-bottom: 1.5rem;
            font-style: italic;
        }

        /* Scenario Box with Illustration */
        .scenario-box {
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .scenario-illustration {
            flex-shrink: 0;
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
        }

        .scenario-content {
            flex: 1;
        }

        .scenario-title {
            font-weight: 800;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        /* Options */
        .options-grid {
            display: grid;
            gap: 1rem;
        }

        .option-btn {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.1);
            color: white;
            padding: 1.2rem 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            text-align: left;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .option-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.15);
            border-color: var(--accent);
            transform: translateX(10px);
        }

        .option-btn.correct {
            background: rgba(46, 204, 113, 0.3);
            border-color: var(--success);
        }

        .option-btn.incorrect {
            background: rgba(231, 76, 60, 0.3);
            border-color: var(--danger);
        }

        .option-btn:disabled {
            cursor: not-allowed;
        }

        .option-letter {
            width: 40px;
            height: 40px;
            background: var(--gradient-1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            flex-shrink: 0;
        }

        /* Feedback */
        .feedback {
            display: none;
            padding: 1.5rem;
            border-radius: 15px;
            margin-top: 1.5rem;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback.show {
            display: block;
        }

        .feedback.success {
            background: rgba(46, 204, 113, 0.2);
            border: 2px solid var(--success);
        }

        .feedback.error {
            background: rgba(231, 76, 60, 0.2);
            border: 2px solid var(--danger);
        }

        .feedback-title {
            font-weight: 800;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feedback-text {
            line-height: 1.6;
        }

        .next-btn {
            background: var(--gradient-4);
            border: none;
            color: var(--dark);
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1.5rem;
            transition: all 0.3s ease;
        }

        .next-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(78, 205, 196, 0.3);
        }

        /* Mini Games */
        .mini-game {
            background: rgba(255,255,255,0.08);
            border-radius: 25px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .mini-game-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Drag and Drop Game */
        .drag-drop-area {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .drop-zone {
            width: 280px;
            min-height: 300px;
            background: rgba(255,255,255,0.05);
            border: 3px dashed rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 1rem;
        }

        .drop-zone.dragover {
            border-color: var(--accent);
            background: rgba(78, 205, 196, 0.1);
        }

        .drop-zone-title {
            text-align: center;
            font-weight: 800;
            padding: 0.8rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .drop-zone.valid .drop-zone-title {
            background: rgba(46, 204, 113, 0.3);
        }

        .drop-zone.invalid .drop-zone-title {
            background: rgba(231, 76, 60, 0.3);
        }

        .draggable-item {
            background: rgba(255,255,255,0.15);
            padding: 1rem;
            border-radius: 10px;
            margin: 0.5rem 0;
            cursor: grab;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .draggable-item:hover {
            background: rgba(255,255,255,0.25);
        }

        .draggable-item.dragging {
            opacity: 0.5;
            transform: scale(1.05);
        }

        .items-pool {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        /* Matching Game */
        .matching-game {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .match-card {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .match-card:hover:not(.matched) {
            transform: scale(1.02);
            background: rgba(255,255,255,0.15);
        }

        .match-card.selected {
            border: 3px solid var(--accent);
            background: rgba(78, 205, 196, 0.2);
        }

        .match-card.matched {
            background: rgba(46, 204, 113, 0.3);
            border: 3px solid var(--success);
        }

        .match-card.wrong {
            animation: shake 0.5s ease;
            background: rgba(231, 76, 60, 0.3);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Calculator Game */
        .calculator-game {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 2rem;
        }

        .calc-scenario {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .calc-info {
            background: rgba(255,255,255,0.08);
            padding: 1.5rem;
            border-radius: 15px;
        }

        .calc-info h4 {
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .calc-info-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .calc-input-group {
            margin-bottom: 1rem;
        }

        .calc-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .calc-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .calc-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .verify-btn {
            background: var(--gradient-1);
            border: none;
            color: white;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .verify-btn:hover {
            transform: scale(1.02);
        }

        /* Summary */
        .summary-screen {
            text-align: center;
            padding: 3rem;
        }

        .summary-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .summary-title {
            font-family: 'Fredoka One', cursive;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .summary-score {
            font-size: 1.5rem;
            margin-bottom: 2rem;
        }

        .summary-score span {
            background: var(--gradient-4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }

        .star-rating {
            font-size: 3rem;
            margin: 2rem 0;
        }

        .star-rating .star {
            color: rgba(255,255,255,0.2);
            transition: color 0.3s ease;
        }

        .star-rating .star.active {
            color: #FFD700;
        }

        /* Info Cards */
        .info-card {
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.2) 0%, rgba(108, 99, 255, 0.2) 100%);
            border-radius: 20px;
            padding: 2rem;
            margin: 1.5rem 0;
            border-left: 5px solid var(--accent);
        }

        .info-card-title {
            font-weight: 800;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .info-card-content {
            line-height: 1.8;
        }

        .highlight {
            background: rgba(255, 215, 0, 0.3);
            padding: 0.2rem 0.5rem;
            border-radius: 5px;
            font-weight: 700;
        }

        /* Illustration SVG */
        .svg-illustration {
            width: 100%;
            max-width: 400px;
            margin: 2rem auto;
        }

        /* Progress bar */
        .progress-container {
            background: rgba(255,255,255,0.1);
            border-radius: 50px;
            height: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--gradient-4);
            border-radius: 50px;
            transition: width 0.5s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-title {
                font-size: 2.5rem;
            }
            
            .characters {
                flex-direction: column;
                align-items: center;
            }
            
            .calc-scenario {
                grid-template-columns: 1fr;
            }
            
            .drag-drop-area {
                flex-direction: column;
                align-items: center;
            }
            
            .drop-zone {
                width: 100%;
            }
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        /* Tooltip */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .tooltip:hover::after {
            opacity: 1;
        }

        /* Badge achievement */
        .badge-achievement {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(0,0,0,0.9);
            padding: 3rem;
            border-radius: 25px;
            text-align: center;
            z-index: 1000;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .badge-achievement.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .badge-achievement-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }

        .badge-achievement-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.5rem;
            color: #FFD700;
        }

        /* Table styling */
        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 1.5rem 0;
            border-radius: 15px;
            overflow: hidden;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .comparison-table th {
            background: rgba(108, 99, 255, 0.3);
            font-weight: 800;
        }

        .comparison-table tr:nth-child(even) td {
            background: rgba(255,255,255,0.03);
        }

        /* Car illustration */
        .car-illustration {
            position: relative;
            width: 100%;
            height: 150px;
            margin: 2rem 0;
            overflow: hidden;
        }

        .car-svg {
            position: absolute;
            bottom: 20px;
            animation: drive 8s linear infinite;
        }

        @keyframes drive {
            0% { left: -100px; }
            100% { left: calc(100% + 100px); }
        }

        .road {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: #333;
            border-top: 3px dashed #fff;
        }
    </style>
</head>
<body>
    <!-- Particles Background -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">üéØ Contrat Quest</div>
            <div class="score-display">
                <div class="score-item">
                    <span class="icon">‚≠ê</span>
                    <span id="totalScore">0</span> pts
                </div>
                <div class="score-item">
                    <span class="icon">üèÜ</span>
                    <span id="badges">0</span> badges
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="welcome-screen">
            <h1 class="welcome-title">Bienvenue dans Contrat Quest!</h1>
            <p class="welcome-subtitle">Deviens expert en droit du travail belge avec Emma et Hugo üáßüá™</p>
            
            <div class="characters">
                <div class="character">
                    <div class="character-avatar emma">üë©‚Äçüíº</div>
                    <div class="character-name">Emma Tomson</div>
                    <div class="character-job">Employ√©e administrative</div>
                    <span class="character-badge badge-cdi">CDI</span>
                </div>
                <div class="character">
                    <div class="character-avatar hugo">üë®‚Äçüîß</div>
                    <div class="character-name">Hugo Devosse</div>
                    <div class="character-job">Op√©rateur de production</div>
                    <span class="character-badge badge-cdd">CDD</span>
                </div>
            </div>

            <p style="margin-bottom: 2rem; opacity: 0.8;">Choisis un module pour commencer ton aventure!</p>

            <div class="modules-grid">
                <div class="module-card" onclick="startModule('conditions')">
                    <div class="module-icon">üìú</div>
                    <div class="module-title">Les 4 Conditions de Validit√©</div>
                    <div class="module-desc">D√©couvre ce qui rend un contrat de travail valide... ou pas!</div>
                    <div class="module-progress">
                        <div class="module-progress-bar" id="progress-conditions" style="width: 0%"></div>
                    </div>
                </div>

                <div class="module-card" onclick="startModule('frais')">
                    <div class="module-icon">üöó</div>
                    <div class="module-title">Frais de D√©placement</div>
                    <div class="module-desc">Domicile-travail vs professionnel : qui paie quoi?</div>
                    <div class="module-progress">
                        <div class="module-progress-bar" id="progress-frais" style="width: 0%"></div>
                    </div>
                </div>

                <div class="module-card" onclick="startModule('representation')">
                    <div class="module-icon">üíº</div>
                    <div class="module-title">Frais de Repr√©sentation</div>
                    <div class="module-desc">Les forfaits, un avantage pour Emma!</div>
                    <div class="module-progress">
                        <div class="module-progress-bar" id="progress-representation" style="width: 0%"></div>
                    </div>
                </div>

                <div class="module-card" onclick="startModule('types')">
                    <div class="module-icon">üìã</div>
                    <div class="module-title">Types de Contrats</div>
                    <div class="module-desc">CDI, CDD, ouvrier, employ√©... compare Emma et Hugo!</div>
                    <div class="module-progress">
                        <div class="module-progress-bar" id="progress-types" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="game-screen">
            <div class="game-header">
                <button class="back-btn" onclick="backToMenu()">
                    ‚Üê Retour au menu
                </button>
                <h2 class="game-title" id="moduleTitle">Module</h2>
                <div id="moduleProgress">1/5</div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="gameProgressBar" style="width: 20%"></div>
            </div>

            <div id="gameContent">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>

        <!-- Summary Screen -->
        <div id="summaryScreen" class="summary-screen hidden">
            <div class="summary-icon" id="summaryIcon">üéâ</div>
            <h2 class="summary-title" id="summaryTitle">Module Termin√©!</h2>
            <div class="star-rating" id="starRating">
                <span class="star">‚≠ê</span>
                <span class="star">‚≠ê</span>
                <span class="star">‚≠ê</span>
            </div>
            <p class="summary-score">Tu as obtenu <span id="moduleScore">0</span> points!</p>
            <button class="next-btn" onclick="backToMenu()">Continuer l'aventure ‚Üí</button>
        </div>
    </div>

    <!-- Badge Achievement Popup -->
    <div id="badgePopup" class="badge-achievement">
        <div class="badge-achievement-icon" id="badgeIcon">üèÜ</div>
        <div class="badge-achievement-title" id="badgeTitle">Badge D√©bloqu√©!</div>
    </div>

    <script>
        // Game State
        const gameState = {
            totalScore: 0,
            badges: 0,
            currentModule: null,
            currentQuestion: 0,
            moduleScore: 0,
            completedModules: {},
            moduleProgress: {
                conditions: 0,
                frais: 0,
                representation: 0,
                types: 0
            }
        };

        // Questions Database
        const modules = {
            conditions: {
                title: "Les 4 Conditions de Validit√©",
                questions: [
                    {
                        type: "info",
                        content: `
                            <div class="info-card">
                                <div class="info-card-title">üìö √Ä retenir!</div>
                                <div class="info-card-content">
                                    <p>Pour qu'un contrat de travail soit <strong>valide</strong>, il faut r√©unir <span class="highlight">4 conditions essentielles</span> :</p>
                                    <br>
                                    <p>1Ô∏è‚É£ <strong>Le consentement</strong> - Les parties doivent √™tre d'accord librement</p>
                                    <p>2Ô∏è‚É£ <strong>La capacit√©</strong> - Les parties doivent pouvoir s'engager juridiquement</p>
                                    <p>3Ô∏è‚É£ <strong>L'objet licite</strong> - Le travail demand√© doit √™tre l√©gal</p>
                                    <p>4Ô∏è‚É£ <strong>L'objet certain</strong> - Les conditions doivent √™tre claires et d√©finies</p>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üò∞",
                            title: "Situation n¬∞1 : La menace",
                            text: "Marco, 19 ans, vient d'arriver en Belgique. Son patron lui dit : ¬´ Si tu ne signes pas ce contrat √† 8‚Ç¨/heure, je garde ton passeport et je te d√©nonce aux autorit√©s! ¬ª"
                        },
                        question: "Quelle condition de validit√© n'est PAS respect√©e ici?",
                        options: [
                            { text: "La capacit√© juridique", correct: false },
                            { text: "Le consentement libre", correct: true },
                            { text: "L'objet licite", correct: false },
                            { text: "L'objet certain", correct: false }
                        ],
                        feedback: {
                            correct: "Excellent! üéØ Le consentement doit √™tre LIBRE, sans menaces ni pressions. Ici, Marco est victime de chantage et ne peut pas d√©cider librement.",
                            incorrect: "Pas tout √† fait... R√©fl√©chis : Marco peut-il vraiment dire 'non' s'il est menac√©? Le probl√®me ici est le CONSENTEMENT qui n'est pas libre!"
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üë¶",
                            title: "Situation n¬∞2 : Le petit g√©nie",
                            text: "Lucas, 14 ans, est un g√©nie de l'informatique. Une startup veut l'embaucher √† temps plein sans l'accord de ses parents."
                        },
                        question: "Pourquoi ce contrat serait-il invalide?",
                        options: [
                            { text: "L'objet n'est pas certain", correct: false },
                            { text: "Le consentement fait d√©faut", correct: false },
                            { text: "Lucas n'a pas la capacit√© juridique pour ce type de contrat", correct: true },
                            { text: "L'informatique n'est pas un travail licite", correct: false }
                        ],
                        feedback: {
                            correct: "Bravo! üëè Un mineur de 14 ans ne peut pas conclure seul un contrat de travail √† temps plein. Il lui faut l'autorisation de son repr√©sentant l√©gal!",
                            incorrect: "R√©fl√©chis √† l'√¢ge de Lucas... Un enfant de 14 ans a-t-il le droit de s'engager seul dans un contrat de travail? C'est une question de CAPACIT√â!"
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üíä",
                            title: "Situation n¬∞3 : Le laboratoire secret",
                            text: "Sarah, chimiste dipl√¥m√©e, se voit proposer un contrat pour fabriquer des amph√©tamines dans un laboratoire clandestin. Le salaire est de 5000‚Ç¨/mois."
                        },
                        question: "Ce contrat est invalide car...",
                        options: [
                            { text: "Le salaire est trop √©lev√©", correct: false },
                            { text: "L'objet du contrat est illicite (fabrication de drogue)", correct: true },
                            { text: "Sarah n'est pas consentante", correct: false },
                            { text: "La capacit√© juridique fait d√©faut", correct: false }
                        ],
                        feedback: {
                            correct: "Exactement! üéØ Fabriquer des drogues est ILL√âGAL. Un contrat ne peut pas porter sur une activit√© criminelle, m√™me si le salaire est attractif!",
                            incorrect: "Pense √† ce qu'on demande √† Sarah de faire... La fabrication de drogue est-elle l√©gale? L'OBJET du contrat doit √™tre LICITE!"
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üéØ",
                            title: "Situation n¬∞4 : L'objectif impossible",
                            text: "Tom signe un contrat de commercial. Sa r√©mun√©ration : ¬´ Un pourcentage sur les ventes, le montant sera d√©cid√© plus tard en fonction de l'humeur du patron ¬ª."
                        },
                        question: "Quel est le probl√®me avec ce contrat?",
                        options: [
                            { text: "Tom n'est pas consentant", correct: false },
                            { text: "L'objet est illicite", correct: false },
                            { text: "Tom n'a pas la capacit√©", correct: false },
                            { text: "L'objet n'est pas certain (r√©mun√©ration ind√©terminable)", correct: true }
                        ],
                        feedback: {
                            correct: "Parfait! üíØ La r√©mun√©ration doit √™tre D√âTERMINABLE √† l'avance. ¬´ Selon l'humeur du patron ¬ª n'est pas un crit√®re objectif! L'objet doit √™tre CERTAIN.",
                            incorrect: "Lis bien les conditions de r√©mun√©ration... ¬´ Selon l'humeur du patron ¬ª permet-il de savoir combien Tom va gagner? L'objet doit √™tre CERTAIN!"
                        }
                    },
                    {
                        type: "matching",
                        title: "üéÆ Jeu d'association : Trouve la condition viol√©e!",
                        instruction: "Associe chaque situation √† la condition de validit√© qui n'est PAS respect√©e",
                        pairs: [
                            { situation: "Employeur menace de r√©v√©ler un secret", condition: "Consentement", id: 1 },
                            { situation: "Contrat avec une personne sous tutelle sans accord du tuteur", condition: "Capacit√©", id: 2 },
                            { situation: "Travail de prostitution forc√©e", condition: "Objet licite", id: 3 },
                            { situation: "Salaire '√† d√©finir un jour'", condition: "Objet certain", id: 4 }
                        ]
                    }
                ]
            },
            frais: {
                title: "Frais de D√©placement",
                questions: [
                    {
                        type: "info",
                        content: `
                            <div class="info-card">
                                <div class="info-card-title">üöó Frais de D√©placement : Comprendre la diff√©rence!</div>
                                <div class="info-card-content">
                                    <p>Il existe <strong>2 types de d√©placements</strong> en voiture :</p>
                                    <br>
                                    <p>üè†‚û°Ô∏èüè¢ <strong>Domicile-Travail</strong> = Trajet PRIV√â (tu choisis o√π tu habites)</p>
                                    <p>üè¢‚û°Ô∏èü§ù <strong>D√©placement professionnel</strong> = Pour le compte de l'employeur</p>
                                    <br>
                                    <p>üí° <strong>Attention!</strong> M√™me si le trajet domicile-travail est consid√©r√© comme "priv√©", il existe une <span class="highlight">exemption fiscale de 500‚Ç¨/an</span> (revenus 2025) si ton employeur te verse une indemnit√©!</p>
                                </div>
                            </div>
                            <div class="car-illustration">
                                <svg class="car-svg" width="80" height="40" viewBox="0 0 80 40">
                                    <rect x="10" y="15" width="50" height="20" rx="5" fill="#6C63FF"/>
                                    <rect x="20" y="5" width="30" height="15" rx="3" fill="#6C63FF"/>
                                    <rect x="25" y="8" width="10" height="10" fill="#87CEEB"/>
                                    <rect x="40" y="8" width="10" height="10" fill="#87CEEB"/>
                                    <circle cx="20" cy="35" r="6" fill="#333"/>
                                    <circle cx="50" cy="35" r="6" fill="#333"/>
                                    <circle cx="20" cy="35" r="3" fill="#666"/>
                                    <circle cx="50" cy="35" r="3" fill="#666"/>
                                </svg>
                                <div class="road"></div>
                            </div>
                        `
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üöó",
                            title: "Le trajet d'Emma",
                            text: "Emma habite √† Ath et travaille chez Belvas √† Ghislenghien. Chaque jour, elle fait 15km aller et 15km retour avec sa voiture personnelle. L'employeur lui rembourse 0,32‚Ç¨/km."
                        },
                        question: "Ce trajet domicile-travail est consid√©r√© comme :",
                        options: [
                            { text: "Un d√©placement professionnel car c'est pour aller travailler", correct: false },
                            { text: "Un d√©placement priv√© car c'est le choix personnel d'habiter √† Ath", correct: true },
                            { text: "Un d√©placement mixte", correct: false },
                            { text: "Aucune de ces r√©ponses", correct: false }
                        ],
                        feedback: {
                            correct: "Exact! üéØ Le trajet domicile-travail est consid√©r√© comme PRIV√â car c'est le travailleur qui choisit son lieu de r√©sidence. Mais bonne nouvelle : il existe une exemption fiscale!",
                            incorrect: "R√©fl√©chis... Qui d√©cide o√π Emma habite? C'est elle! Le trajet domicile-travail est donc consid√©r√© comme un choix PRIV√â."
                        }
                    },
                    {
                        type: "calculator",
                        title: "üßÆ Calcul : L'exemption fiscale d'Emma",
                        scenario: `Emma parcourt 30 km/jour (aller-retour) pendant 220 jours de travail par an.
                        Son employeur lui rembourse 0,32‚Ç¨/km.`,
                        questions: [
                            {
                                label: "Combien de km Emma parcourt-elle par an?",
                                answer: 6600,
                                unit: "km",
                                hint: "30 km √ó 220 jours = ?"
                            },
                            {
                                label: "Combien re√ßoit-elle de son employeur par an?",
                                answer: 2112,
                                unit: "‚Ç¨",
                                hint: "6600 km √ó 0,32‚Ç¨ = ?"
                            },
                            {
                                label: "Montant exon√©r√© d'imp√¥ts (max 500‚Ç¨)?",
                                answer: 500,
                                unit: "‚Ç¨",
                                hint: "L'exemption est plafonn√©e √† 500‚Ç¨"
                            }
                        ],
                        explanation: "Emma re√ßoit 2112‚Ç¨ mais seuls 500‚Ç¨ sont exon√©r√©s d'imp√¥ts. Le reste (1612‚Ç¨) est consid√©r√© comme un avantage imposable... sauf si elle opte pour les frais r√©els!"
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "ü§ù",
                            title: "Emma en mission",
                            text: "Aujourd'hui, Emma doit se rendre chez un client √† Bruxelles pour une r√©union. Elle utilise sa voiture personnelle depuis le bureau de Belvas."
                        },
                        question: "Ce d√©placement Belvas ‚Üí Bruxelles est :",
                        options: [
                            { text: "Un d√©placement priv√©", correct: false },
                            { text: "Un d√©placement professionnel enti√®rement remboursable", correct: true },
                            { text: "Non remboursable", correct: false },
                            { text: "√Ä charge du client", correct: false }
                        ],
                        feedback: {
                            correct: "Bravo! üéØ Ce d√©placement est 100% PROFESSIONNEL car Emma se d√©place pour le compte de son employeur. Il est rembours√© √† 0,32‚Ç¨/km selon son contrat!",
                            incorrect: "Attention! Emma se d√©place pour rencontrer un CLIENT de Belvas. C'est donc un d√©placement PROFESSIONNEL pour le compte de l'employeur."
                        }
                    },
                    {
                        type: "dragdrop",
                        title: "üéÆ Trie les d√©placements!",
                        instruction: "Glisse chaque situation dans la bonne cat√©gorie",
                        items: [
                            { text: "Ath ‚Üí Belvas chaque matin", category: "prive" },
                            { text: "Belvas ‚Üí Client √† Bruxelles", category: "pro" },
                            { text: "Visite fournisseur √† Li√®ge", category: "pro" },
                            { text: "Retour du bureau √† la maison", category: "prive" },
                            { text: "Formation obligatoire √† Namur", category: "pro" },
                            { text: "Choix d'habiter plus loin", category: "prive" }
                        ],
                        categories: {
                            prive: "üè† D√©placement PRIV√â",
                            pro: "üíº D√©placement PROFESSIONNEL"
                        }
                    },
                    {
                        type: "info",
                        content: `
                            <div class="info-card">
                                <div class="info-card-title">üìä R√©capitulatif - √Ä retenir pour l'examen!</div>
                                <div class="info-card-content">
                                    <table class="comparison-table">
                                        <tr>
                                            <th>Crit√®re</th>
                                            <th>Domicile-Travail</th>
                                            <th>Professionnel</th>
                                        </tr>
                                        <tr>
                                            <td>Nature</td>
                                            <td>Priv√©</td>
                                            <td>Professionnel</td>
                                        </tr>
                                        <tr>
                                            <td>Obligation employeur</td>
                                            <td>Non (sauf CCT)</td>
                                            <td>Oui</td>
                                        </tr>
                                        <tr>
                                            <td>Exemption fiscale 2025</td>
                                            <td>Max 500‚Ç¨/an</td>
                                            <td>100% si forfait √âtat</td>
                                        </tr>
                                        <tr>
                                            <td>Chez Belvas (Emma)</td>
                                            <td>0,32‚Ç¨/km</td>
                                            <td>0,32‚Ç¨/km</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        `
                    }
                ]
            },
            representation: {
                title: "Frais de Repr√©sentation",
                questions: [
                    {
                        type: "info",
                        content: `
                            <div class="info-card">
                                <div class="info-card-title">üíº Les Frais de Repr√©sentation : Le cas d'Emma</div>
                                <div class="info-card-content">
                                    <p>Dans son contrat, Emma b√©n√©ficie de <span class="highlight">125‚Ç¨/mois de frais de repr√©sentation</span>.</p>
                                    <br>
                                    <p>ü§î <strong>C'est quoi exactement?</strong></p>
                                    <p>Ce sont des frais forfaitaires pour couvrir les d√©penses li√©es √† l'image professionnelle : v√™tements de travail, repas d'affaires, petits cadeaux clients, etc.</p>
                                    <br>
                                    <p>üí° <strong>Avantage majeur :</strong> Ces 125‚Ç¨ ne sont PAS soumis aux cotisations sociales ni √† l'imp√¥t (si justifi√©s et raisonnables)!</p>
                                </div>
                            </div>
                            <div class="scenario-box">
                                <div class="scenario-illustration">üë©‚Äçüíº</div>
                                <div class="scenario-content">
                                    <div class="scenario-title">Le contrat d'Emma pr√©cise :</div>
                                    <p>"Les frais de repr√©sentation sont pris en charge par l'employeur et s'√©l√®vent √† 125 Euros par mois."</p>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üí∞",
                            title: "Le calcul d'Emma",
                            text: "Emma gagne 2000‚Ç¨ brut/mois + 125‚Ç¨ de frais de repr√©sentation. Elle se demande si elle doit payer des cotisations sociales sur les 125‚Ç¨."
                        },
                        question: "Les frais de repr√©sentation forfaitaires sont-ils soumis aux cotisations sociales?",
                        options: [
                            { text: "Oui, c'est du salaire d√©guis√©", correct: false },
                            { text: "Non, s'ils sont raisonnables et correspondent √† des frais r√©els", correct: true },
                            { text: "Seulement au-del√† de 100‚Ç¨", correct: false },
                            { text: "Toujours tax√©s √† 50%", correct: false }
                        ],
                        feedback: {
                            correct: "Exact! üéØ Les frais de repr√©sentation forfaitaires ne sont pas consid√©r√©s comme de la r√©mun√©ration s'ils couvrent des frais r√©els et restent raisonnables. C'est un vrai avantage!",
                            incorrect: "R√©fl√©chis... Les frais de repr√©sentation servent √† rembourser des d√©penses professionnelles. S'ils sont raisonnables, ils ne sont pas tax√©s!"
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üìä",
                            title: "Comparaison annuelle",
                            text: "Emma re√ßoit 125‚Ç¨/mois de frais de repr√©sentation. Calculons l'avantage annuel par rapport √† un salaire √©quivalent."
                        },
                        question: "Combien Emma √©conomise-t-elle en cotisations sociales par an si on consid√®re ~13% de cotisations travailleur √©vit√©es?",
                        options: [
                            { text: "Environ 75‚Ç¨/an", correct: false },
                            { text: "Environ 195‚Ç¨/an", correct: true },
                            { text: "Environ 500‚Ç¨/an", correct: false },
                            { text: "0‚Ç¨, il n'y a pas d'√©conomie", correct: false }
                        ],
                        feedback: {
                            correct: "Bravo! 125‚Ç¨ √ó 12 mois = 1500‚Ç¨/an. 1500‚Ç¨ √ó 13% ‚âà 195‚Ç¨ d'√©conomie sur les cotisations! Et il y a aussi l'√©conomie d'imp√¥ts! üí∞",
                            incorrect: "Calcule : 125‚Ç¨ √ó 12 mois = 1500‚Ç¨/an. Avec environ 13% de cotisations √©vit√©es : 1500‚Ç¨ √ó 0,13 ‚âà 195‚Ç¨"
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "‚ö†Ô∏è",
                            title: "Attention aux abus!",
                            text: "Un employeur propose √† son employ√© de lui verser 2000‚Ç¨/mois en 'frais de repr√©sentation' au lieu d'un salaire normal pour √©viter les taxes."
                        },
                        question: "Que risque cet employeur?",
                        options: [
                            { text: "Rien, c'est l√©gal", correct: false },
                            { text: "Un redressement fiscal et social car c'est du salaire d√©guis√©", correct: true },
                            { text: "Une m√©daille pour sa cr√©ativit√©", correct: false },
                            { text: "Juste un avertissement verbal", correct: false }
                        ],
                        feedback: {
                            correct: "Exact! üéØ L'ONSS et le fisc peuvent requalifier ces sommes en salaire si elles sont disproportionn√©es. Sanctions : rappel de cotisations + int√©r√™ts + amendes!",
                            incorrect: "2000‚Ç¨ de frais de repr√©sentation? C'est clairement excessif! L'administration consid√©rera cela comme du SALAIRE D√âGUIS√â avec des cons√©quences fiscales et sociales."
                        }
                    },
                    {
                        type: "dragdrop",
                        title: "üéÆ Vrai ou Faux : Les frais de repr√©sentation",
                        instruction: "Glisse chaque affirmation dans la bonne colonne",
                        items: [
                            { text: "125‚Ç¨/mois pour une employ√©e administrative = raisonnable", category: "vrai" },
                            { text: "Les frais doivent couvrir des d√©penses r√©elles", category: "vrai" },
                            { text: "On peut donner 5000‚Ç¨/mois en frais de repr√©sentation", category: "faux" },
                            { text: "Hugo (ouvrier) a aussi des frais de repr√©sentation chez Belvas", category: "faux" }
                        ],
                        categories: {
                            vrai: "‚úÖ VRAI",
                            faux: "‚ùå FAUX"
                        }
                    }
                ]
            },
            types: {
                title: "Types de Contrats",
                questions: [
                    {
                        type: "info",
                        content: `
                            <div class="info-card">
                                <div class="info-card-title">üìã Emma vs Hugo : Comparons leurs contrats!</div>
                                <div class="info-card-content">
                                    <table class="comparison-table">
                                        <tr>
                                            <th>Crit√®re</th>
                                            <th>üë©‚Äçüíº Emma</th>
                                            <th>üë®‚Äçüîß Hugo</th>
                                        </tr>
                                        <tr>
                                            <td>Statut</td>
                                            <td>Employ√©e</td>
                                            <td>Ouvrier</td>
                                        </tr>
                                        <tr>
                                            <td>Dur√©e</td>
                                            <td>CDI</td>
                                            <td>CDD (2 mois)</td>
                                        </tr>
                                        <tr>
                                            <td>R√©mun√©ration</td>
                                            <td>2000‚Ç¨/mois</td>
                                            <td>13‚Ç¨/heure</td>
                                        </tr>
                                        <tr>
                                            <td>Commission paritaire</td>
                                            <td>CP 201</td>
                                            <td>CP 118</td>
                                        </tr>
                                        <tr>
                                            <td>Frais repr√©sentation</td>
                                            <td>125‚Ç¨/mois</td>
                                            <td>Aucun</td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üè≠",
                            title: "La nature du travail",
                            text: "Hugo travaille comme op√©rateur de production chez Belvas (chocolaterie). Il effectue un travail principalement manuel : fabrication, conditionnement..."
                        },
                        question: "Pourquoi Hugo est-il class√© comme 'ouvrier' et non 'employ√©'?",
                        options: [
                            { text: "Parce qu'il gagne moins qu'Emma", correct: false },
                            { text: "Parce qu'il effectue un travail principalement manuel", correct: true },
                            { text: "Parce qu'il est en CDD", correct: false },
                            { text: "C'est son choix personnel", correct: false }
                        ],
                        feedback: {
                            correct: "Exact! üéØ La distinction ouvrier/employ√© se base sur la NATURE du travail : manuel = ouvrier, intellectuel = employ√©. Hugo fait un travail physique de production.",
                            incorrect: "La diff√©rence ouvrier/employ√© n'est pas li√©e au salaire ou au type de contrat, mais √† la NATURE du travail : manuel vs intellectuel."
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üìÖ",
                            title: "Le CDD d'Hugo",
                            text: "Hugo a un CDD du 1er novembre au 31 d√©cembre 2017 (2 mois). Belvas aimerait le garder plus longtemps avec des CDD successifs."
                        },
                        question: "Combien de CDD successifs maximum Belvas peut-elle proposer √† Hugo?",
                        options: [
                            { text: "Autant qu'elle veut", correct: false },
                            { text: "Maximum 2 CDD", correct: false },
                            { text: "Maximum 4 CDD (si min 3 mois chacun et max 2 ans au total)", correct: true },
                            { text: "1 seul, apr√®s c'est obligatoirement un CDI", correct: false }
                        ],
                        feedback: {
                            correct: "Bravo! üéØ La loi limite √† 4 CDD successifs, avec minimum 3 mois par contrat et maximum 2 ans au total. Cela √©vite les abus!",
                            incorrect: "La loi belge encadre les CDD successifs : maximum 4 contrats, minimum 3 mois chacun, maximum 2 ans au total."
                        }
                    },
                    {
                        type: "quiz",
                        scenario: {
                            icon: "üíµ",
                            title: "La r√©mun√©ration",
                            text: "Emma est pay√©e 2000‚Ç¨/mois. Hugo est pay√© 13‚Ç¨/heure. Pourquoi cette diff√©rence de mode de paiement?"
                        },
                        question: "Traditionnellement en Belgique, comment sont pay√©s les ouvriers vs les employ√©s?",
                        options: [
                            { text: "Ouvriers au mois, employ√©s √† l'heure", correct: false },
                            { text: "Ouvriers √† l'heure, employ√©s au mois", correct: true },
                            { text: "Tous au mois depuis 2014", correct: false },
                            { text: "Cela d√©pend uniquement du contrat", correct: false }
                        ],
                        feedback: {
                            correct: "Exact! üéØ Historiquement, les ouvriers sont pay√©s √† l'heure (li√© au temps de production) et les employ√©s au mois. Cette distinction tend √† s'att√©nuer mais reste fr√©quente.",
                            incorrect: "Traditionnellement, les OUVRIERS sont pay√©s √† l'HEURE et les EMPLOY√âS au MOIS, m√™me si cette distinction s'estompe progressivement."
                        }
                    },
                    {
                        type: "dragdrop",
                        title: "üéÆ Qui est qui? Emma ou Hugo?",
                        instruction: "Associe chaque caract√©ristique √† la bonne personne",
                        items: [
                            { text: "Travail manuel de production", category: "hugo" },
                            { text: "R√©mun√©ration mensuelle fixe", category: "emma" },
                            { text: "Commission paritaire 118", category: "hugo" },
                            { text: "Frais de repr√©sentation 125‚Ç¨", category: "emma" },
                            { text: "Contrat √† dur√©e d√©termin√©e", category: "hugo" },
                            { text: "Suivi administratif des commandes", category: "emma" },
                            { text: "Pay√© 13‚Ç¨/heure", category: "hugo" },
                            { text: "CDI", category: "emma" }
                        ],
                        categories: {
                            emma: "üë©‚Äçüíº Emma (Employ√©e)",
                            hugo: "üë®‚Äçüîß Hugo (Ouvrier)"
                        }
                    },
                    {
                        type: "info",
                        content: `
                            <div class="info-card">
                                <div class="info-card-title">üéì Les 4 √©l√©ments essentiels du contrat de travail</div>
                                <div class="info-card-content">
                                    <p>Rappel : Pour qu'il y ait contrat de travail, il faut :</p>
                                    <br>
                                    <p>1Ô∏è‚É£ <strong>Un contrat</strong> (√©crit ou verbal, m√™me tacite)</p>
                                    <p>2Ô∏è‚É£ <strong>Un travail</strong> √† effectuer</p>
                                    <p>3Ô∏è‚É£ <strong>Une r√©mun√©ration</strong> en √©change</p>
                                    <p>4Ô∏è‚É£ <strong>Un lien de subordination</strong> (autorit√© de l'employeur)</p>
                                    <br>
                                    <p>üí° Ces √©l√©ments ne peuvent pas √™tre modifi√©s unilat√©ralement par l'employeur sans l'accord du travailleur!</p>
                                </div>
                            </div>
                        `
                    }
                ]
            }
        };

        // Initialize particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Start Module
        function startModule(moduleId) {
            gameState.currentModule = moduleId;
            gameState.currentQuestion = 0;
            gameState.moduleScore = 0;
            
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.add('active');
            document.getElementById('summaryScreen').classList.add('hidden');
            
            document.getElementById('moduleTitle').textContent = modules[moduleId].title;
            
            loadQuestion();
        }

        // Load Question
        function loadQuestion() {
            const module = modules[gameState.currentModule];
            const question = module.questions[gameState.currentQuestion];
            const total = module.questions.length;
            
            document.getElementById('moduleProgress').textContent = `${gameState.currentQuestion + 1}/${total}`;
            document.getElementById('gameProgressBar').style.width = `${((gameState.currentQuestion + 1) / total) * 100}%`;
            
            const content = document.getElementById('gameContent');
            
            switch(question.type) {
                case 'info':
                    renderInfo(content, question);
                    break;
                case 'quiz':
                    renderQuiz(content, question);
                    break;
                case 'matching':
                    renderMatching(content, question);
                    break;
                case 'dragdrop':
                    renderDragDrop(content, question);
                    break;
                case 'calculator':
                    renderCalculator(content, question);
                    break;
            }
        }

        // Render Info
        function renderInfo(content, question) {
            content.innerHTML = `
                <div class="question-card">
                    ${question.content}
                    <button class="next-btn" onclick="nextQuestion()">J'ai compris! ‚Üí</button>
                </div>
            `;
        }

        // Render Quiz
        function renderQuiz(content, question) {
            let scenarioHtml = '';
            if (question.scenario) {
                scenarioHtml = `
                    <div class="scenario-box">
                        <div class="scenario-illustration">${question.scenario.icon}</div>
                        <div class="scenario-content">
                            <div class="scenario-title">${question.scenario.title}</div>
                            <p>${question.scenario.text}</p>
                        </div>
                    </div>
                `;
            }
            
            const letters = ['A', 'B', 'C', 'D'];
            let optionsHtml = question.options.map((opt, i) => `
                <button class="option-btn" onclick="checkAnswer(${i}, ${opt.correct})">
                    <span class="option-letter">${letters[i]}</span>
                    <span>${opt.text}</span>
                </button>
            `).join('');
            
            content.innerHTML = `
                <div class="question-card">
                    <span class="question-number">Question ${gameState.currentQuestion + 1}</span>
                    ${scenarioHtml}
                    <p class="question-text">${question.question}</p>
                    <div class="options-grid">
                        ${optionsHtml}
                    </div>
                    <div id="feedback" class="feedback"></div>
                </div>
            `;
        }

        // Check Answer
        function checkAnswer(index, correct) {
            const buttons = document.querySelectorAll('.option-btn');
            const feedback = document.getElementById('feedback');
            const question = modules[gameState.currentModule].questions[gameState.currentQuestion];
            
            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (question.options[i].correct) {
                    btn.classList.add('correct');
                } else if (i === index && !correct) {
                    btn.classList.add('incorrect');
                }
            });
            
            if (correct) {
                gameState.moduleScore += 100;
                gameState.totalScore += 100;
                updateScore();
                feedback.className = 'feedback show success';
                feedback.innerHTML = `
                    <div class="feedback-title">‚úÖ Correct!</div>
                    <div class="feedback-text">${question.feedback.correct}</div>
                    <button class="next-btn" onclick="nextQuestion()">Continuer ‚Üí</button>
                `;
            } else {
                feedback.className = 'feedback show error';
                feedback.innerHTML = `
                    <div class="feedback-title">‚ùå Pas tout √† fait...</div>
                    <div class="feedback-text">${question.feedback.incorrect}</div>
                    <button class="next-btn" onclick="nextQuestion()">Continuer ‚Üí</button>
                `;
            }
        }

        // Render Matching Game
        function renderMatching(content, question) {
            const shuffledPairs = [...question.pairs].sort(() => Math.random() - 0.5);
            const situations = shuffledPairs.map(p => ({ text: p.situation, id: p.id }));
            const conditions = [...new Set(question.pairs.map(p => p.condition))].sort(() => Math.random() - 0.5);
            
            let situationsHtml = situations.map(s => `
                <div class="match-card" data-id="${s.id}" data-type="situation" onclick="selectMatch(this, 'situation')">${s.text}</div>
            `).join('');
            
            let conditionsHtml = conditions.map(c => `
                <div class="match-card" data-condition="${c}" data-type="condition" onclick="selectMatch(this, 'condition')">${c}</div>
            `).join('');
            
            content.innerHTML = `
                <div class="mini-game">
                    <div class="mini-game-title">üéÆ ${question.title}</div>
                    <p style="margin-bottom: 1.5rem; opacity: 0.8;">${question.instruction}</p>
                    <div class="matching-game">
                        ${situationsHtml}
                        ${conditionsHtml}
                    </div>
                    <div id="matchFeedback" style="margin-top: 1rem;"></div>
                </div>
            `;
            
            window.matchState = {
                selected: null,
                pairs: question.pairs,
                matched: 0,
                total: question.pairs.length
            };
        }

        function selectMatch(element, type) {
            if (element.classList.contains('matched')) return;
            
            if (window.matchState.selected && window.matchState.selected.type === type) {
                window.matchState.selected.element.classList.remove('selected');
            }
            
            if (window.matchState.selected && window.matchState.selected.type !== type) {
                // Check match
                const situationEl = type === 'situation' ? element : window.matchState.selected.element;
                const conditionEl = type === 'condition' ? element : window.matchState.selected.element;
                
                const situationId = parseInt(situationEl.dataset.id);
                const condition = conditionEl.dataset.condition;
                
                const pair = window.matchState.pairs.find(p => p.id === situationId);
                
                if (pair.condition === condition) {
                    situationEl.classList.add('matched');
                    conditionEl.classList.add('matched');
                    situationEl.classList.remove('selected');
                    conditionEl.classList.remove('selected');
                    window.matchState.matched++;
                    gameState.moduleScore += 25;
                    gameState.totalScore += 25;
                    updateScore();
                    
                    if (window.matchState.matched === window.matchState.total) {
                        document.getElementById('matchFeedback').innerHTML = `
                            <div class="feedback show success">
                                <div class="feedback-title">üéâ Parfait! Toutes les associations sont correctes!</div>
                                <button class="next-btn" onclick="nextQuestion()">Continuer ‚Üí</button>
                            </div>
                        `;
                    }
                } else {
                    situationEl.classList.add('wrong');
                    conditionEl.classList.add('wrong');
                    setTimeout(() => {
                        situationEl.classList.remove('wrong', 'selected');
                        conditionEl.classList.remove('wrong', 'selected');
                    }, 500);
                }
                window.matchState.selected = null;
            } else {
                element.classList.add('selected');
                window.matchState.selected = { element, type };
            }
        }

        // Render Drag and Drop
        function renderDragDrop(content, question) {
            const shuffledItems = [...question.items].sort(() => Math.random() - 0.5);
            
            let itemsHtml = shuffledItems.map((item, i) => `
                <div class="draggable-item" draggable="true" data-category="${item.category}" id="item-${i}">${item.text}</div>
            `).join('');
            
            let categoriesHtml = Object.entries(question.categories).map(([key, label]) => `
                <div class="drop-zone" data-category="${key}">
                    <div class="drop-zone-title">${label}</div>
                    <div class="drop-content"></div>
                </div>
            `).join('');
            
            content.innerHTML = `
                <div class="mini-game">
                    <div class="mini-game-title">üéÆ ${question.title}</div>
                    <p style="margin-bottom: 1.5rem; opacity: 0.8;">${question.instruction}</p>
                    <div class="items-pool" id="itemsPool">
                        ${itemsHtml}
                    </div>
                    <div class="drag-drop-area">
                        ${categoriesHtml}
                    </div>
                    <div id="dragFeedback" style="margin-top: 1rem;"></div>
                </div>
            `;
            
            initDragDrop(question.items.length);
        }

        function initDragDrop(totalItems) {
            const items = document.querySelectorAll('.draggable-item');
            const zones = document.querySelectorAll('.drop-zone');
            
            window.dragState = {
                placed: 0,
                correct: 0,
                total: totalItems
            };
            
            items.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', item.id);
                    item.classList.add('dragging');
                });
                
                item.addEventListener('dragend', () => {
                    item.classList.remove('dragging');
                });
            });
            
            zones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('dragover');
                });
                
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('dragover');
                });
                
                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('dragover');
                    
                    const itemId = e.dataTransfer.getData('text/plain');
                    const item = document.getElementById(itemId);
                    const dropContent = zone.querySelector('.drop-content');
                    
                    if (item && !dropContent.contains(item)) {
                        dropContent.appendChild(item);
                        item.draggable = false;
                        
                        const isCorrect = item.dataset.category === zone.dataset.category;
                        window.dragState.placed++;
                        
                        if (isCorrect) {
                            window.dragState.correct++;
                            item.style.background = 'rgba(46, 204, 113, 0.3)';
                            item.style.borderLeft = '4px solid #2ECC71';
                            gameState.moduleScore += 20;
                            gameState.totalScore += 20;
                            updateScore();
                        } else {
                            item.style.background = 'rgba(231, 76, 60, 0.3)';
                            item.style.borderLeft = '4px solid #E74C3C';
                        }
                        
                        if (window.dragState.placed === window.dragState.total) {
                            const percentage = (window.dragState.correct / window.dragState.total) * 100;
                            document.getElementById('dragFeedback').innerHTML = `
                                <div class="feedback show ${percentage >= 70 ? 'success' : 'error'}">
                                    <div class="feedback-title">${percentage >= 70 ? 'üéâ Bien jou√©!' : 'ü§î Pas mal, mais r√©vise!'}</div>
                                    <div class="feedback-text">Tu as ${window.dragState.correct}/${window.dragState.total} bonnes r√©ponses (${percentage.toFixed(0)}%)</div>
                                    <button class="next-btn" onclick="nextQuestion()">Continuer ‚Üí</button>
                                </div>
                            `;
                        }
                    }
                });
            });
        }

        // Render Calculator
        function renderCalculator(content, question) {
            let questionsHtml = question.questions.map((q, i) => `
                <div class="calc-input-group">
                    <label>${q.label}</label>
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <input type="number" class="calc-input" id="calc-${i}" placeholder="${q.hint}">
                        <span style="font-weight: 700;">${q.unit}</span>
                    </div>
                    <small style="opacity: 0.6; font-style: italic;">${q.hint}</small>
                </div>
            `).join('');
            
            content.innerHTML = `
                <div class="mini-game">
                    <div class="mini-game-title">üßÆ ${question.title}</div>
                    <div class="calculator-game">
                        <div class="scenario-box" style="margin-bottom: 2rem;">
                            <div class="scenario-illustration">üöó</div>
                            <div class="scenario-content">
                                <div class="scenario-title">Sc√©nario</div>
                                <p>${question.scenario}</p>
                            </div>
                        </div>
                        ${questionsHtml}
                        <button class="verify-btn" onclick="verifyCalculations()">V√©rifier mes calculs ‚úì</button>
                        <div id="calcFeedback" style="margin-top: 1rem;"></div>
                    </div>
                </div>
            `;
            
            window.calcState = {
                questions: question.questions,
                explanation: question.explanation
            };
        }

        function verifyCalculations() {
            let correct = 0;
            const total = window.calcState.questions.length;
            
            window.calcState.questions.forEach((q, i) => {
                const input = document.getElementById(`calc-${i}`);
                const value = parseFloat(input.value);
                
                if (Math.abs(value - q.answer) < 1) {
                    correct++;
                    input.style.borderColor = '#2ECC71';
                    input.style.background = 'rgba(46, 204, 113, 0.2)';
                } else {
                    input.style.borderColor = '#E74C3C';
                    input.style.background = 'rgba(231, 76, 60, 0.2)';
                }
            });
            
            gameState.moduleScore += correct * 30;
            gameState.totalScore += correct * 30;
            updateScore();
            
            const answers = window.calcState.questions.map(q => `${q.label}: <strong>${q.answer} ${q.unit}</strong>`).join('<br>');
            
            document.getElementById('calcFeedback').innerHTML = `
                <div class="feedback show ${correct === total ? 'success' : 'error'}">
                    <div class="feedback-title">${correct === total ? 'üéâ Parfait!' : `${correct}/${total} bonnes r√©ponses`}</div>
                    <div class="feedback-text">
                        <p><strong>R√©ponses correctes :</strong></p>
                        <p>${answers}</p>
                        <br>
                        <p><strong>üí° Explication :</strong> ${window.calcState.explanation}</p>
                    </div>
                    <button class="next-btn" onclick="nextQuestion()">Continuer ‚Üí</button>
                </div>
            `;
        }

        // Next Question
        function nextQuestion() {
            const module = modules[gameState.currentModule];
            gameState.currentQuestion++;
            
            if (gameState.currentQuestion >= module.questions.length) {
                showSummary();
            } else {
                loadQuestion();
            }
        }

        // Show Summary
        function showSummary() {
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('summaryScreen').classList.remove('hidden');
            
            const score = gameState.moduleScore;
            const maxScore = modules[gameState.currentModule].questions.length * 100;
            const percentage = (score / maxScore) * 100;
            
            document.getElementById('moduleScore').textContent = score;
            
            // Stars
            const stars = document.querySelectorAll('.star-rating .star');
            if (percentage >= 30) stars[0].classList.add('active');
            if (percentage >= 60) stars[1].classList.add('active');
            if (percentage >= 90) stars[2].classList.add('active');
            
            // Update progress
            gameState.moduleProgress[gameState.currentModule] = Math.min(100, percentage);
            document.getElementById(`progress-${gameState.currentModule}`).style.width = `${percentage}%`;
            
            // Check for badge
            if (percentage >= 70 && !gameState.completedModules[gameState.currentModule]) {
                gameState.completedModules[gameState.currentModule] = true;
                gameState.badges++;
                updateScore();
                showBadge();
            }
        }

        // Show Badge
        function showBadge() {
            const popup = document.getElementById('badgePopup');
            const icons = ['üèÜ', 'üéñÔ∏è', 'ü•á', '‚≠ê'];
            const titles = ['Expert du Module!', 'Ma√Ætre du Droit!', 'Champion!', 'Brillant!'];
            
            document.getElementById('badgeIcon').textContent = icons[Math.floor(Math.random() * icons.length)];
            document.getElementById('badgeTitle').textContent = titles[Math.floor(Math.random() * titles.length)];
            
            popup.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        // Back to Menu
        function backToMenu() {
            document.getElementById('welcomeScreen').classList.remove('hidden');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('summaryScreen').classList.add('hidden');
            
            // Reset stars
            document.querySelectorAll('.star-rating .star').forEach(star => star.classList.remove('active'));
        }

        // Update Score Display
        function updateScore() {
            document.getElementById('totalScore').textContent = gameState.totalScore;
            document.getElementById('badges').textContent = gameState.badges;
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            createParticles();
        });
    </script>
</body>
</html>
